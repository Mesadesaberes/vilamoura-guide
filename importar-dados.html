<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Importar Dados - Vilamoura Select</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f4f7f9; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #003366; }
        .btn { padding: 12px 24px; background: #003366; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
        .btn:hover { background: #004080; }
        .success { background: #d4edda; color: #155724; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .error { background: #f8d7da; color: #721c24; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .category { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        .category h2 { color: #003366; margin-top: 0; }
        .note { font-size: 12px; color: #666; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“¥ Importar Dados para Firebase</h1>
        <p class="note">Nota: As imagens usam placeholders. Pode substituir por fotos reais depois.</p>
        
        <div id="messages"></div>
        
        <div class="category">
            <h2>ğŸš— Transportes (4 negÃ³cios)</h2>
            <button class="btn" onclick="importTransportes()">Importar Transportes</button>
        </div>
        
        <div class="category">
            <h2>ğŸ¯ ExperiÃªncias & Atividades (8 negÃ³cios)</h2>
            <button class="btn" onclick="importExperiencias()">Importar ExperiÃªncias</button>
        </div>
        
        <div class="category">
            <h2>ğŸ“Š Verificar Dados</h2>
            <button class="btn" onclick="checkData()">Verificar ColeÃ§Ã£o 'locais'</button>
        </div>
        
        <div class="category">
            <h2>ğŸ—‘ï¸ Limpar Duplicados (Opcional)</h2>
            <button class="btn" style="background:#dc3545;" onclick="cleanDuplicates()">Remover Duplicados</button>
            <p class="note">Remove negÃ³cios duplicados por nome nas novas categorias.</p>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDfUDqEJxVnWbQgn6LEVQAjlKeBJdp0vyY",
            authDomain: "vilamoura-select.firebaseapp.com",
            projectId: "vilamoura-select",
            storageBucket: "vilamoura-select.firebasestorage.app",
            messagingSenderId: "189990454398",
            appId: "1:189990454398:web:3d9eac9cf3a84b0510c42f"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Placeholder image generator (sem espaÃ§os = sem erros)
        const placeholder = (text) => 
            `https://via.placeholder.com/400x300/003366/ffffff?text=${encodeURIComponent(text)}`;

        // ğŸš— TRANSPORTES - 4 negÃ³cios Ãºnicos
        const transportes = [
            {
                nome: "Vilamoura Taxi",
                cat: "transportes",
                icon: "ğŸš–",
                info: { pt: "TÃ¡xis e transfers aeroporto 24h. ServiÃ§o profissional.", en: "Taxis and airport transfers 24h. Professional service." },
                tel: "+351932451496",
                web: "https://vilamourataxi.com",
                lat: 37.0760,
                lng: -8.1180,
                img: placeholder("Vilamoura-Taxi")
            },
            {
                nome: "Taxis Vilamoura",
                cat: "transportes",
                icon: "ğŸš•",
                info: { pt: "ServiÃ§o de tÃ¡xis local. DisponÃ­vel 24 horas.", en: "Local taxi service. Available 24 hours." },
                tel: "+351915688249",
                web: "https://taxisvilamoura.com",
                lat: 37.0765,
                lng: -8.1175,
                img: placeholder("Taxis-Vilamoura")
            },
            {
                nome: "EVA Transportes",
                cat: "transportes",
                icon: "ğŸšŒ",
                info: { pt: "Autocarros para Faro, Albufeira e LoulÃ©.", en: "Buses to Faro, Albufeira and LoulÃ©." },
                tel: "+351289389143",
                web: "https://eva-bus.com",
                lat: 37.0770,
                lng: -8.1170,
                img: placeholder("EVA-Transportes")
            },
            {
                nome: "Faro Airport Transfers",
                cat: "transportes",
                icon: "ğŸš",
                info: { pt: "Transfers privados aeroporto. AtÃ© 4 pessoas.", en: "Private airport transfers. Up to 4 people." },
                tel: "",
                web: "https://faro-airport-taxis.com",
                lat: 37.0755,
                lng: -8.1185,
                img: placeholder("Airport-Transfers")
            }
        ];

        // ğŸ¯ EXPERIÃŠNCIAS - 8 negÃ³cios Ãºnicos (SEM golf courses)
        const experiencias = [
            {
                nome: "Algarve Cave Tours",
                cat: "experiencias",
                icon: "ğŸš¤",
                info: { pt: "Passeios de barco Ã s grutas de Benagil.", en: "Boat tours to Benagil caves." },
                tel: "",
                web: "https://algarvecavetours.com",
                lat: 37.0750,
                lng: -8.1190,
                img: placeholder("Cave-Tours")
            },
            {
                nome: "Vilamoura Watersports",
                cat: "experiencias",
                icon: "ğŸ„",
                info: { pt: "Jet ski, parasailing, passeios de barco.", en: "Jet ski, parasailing, boat trips." },
                tel: "",
                web: "https://watersportsalgarve.com",
                lat: 37.0745,
                lng: -8.1195,
                img: placeholder("Watersports")
            },
            {
                nome: "Dreams Cruises",
                cat: "experiencias",
                icon: "â›µ",
                info: { pt: "Passeios de barco, paddle board, snorkeling.", en: "Boat trips, paddle board, snorkeling." },
                tel: "",
                web: "https://vilamouradreamscruises.com",
                lat: 37.0740,
                lng: -8.1200,
                img: placeholder("Dreams-Cruises")
            },
            {
                nome: "Baja Bikes Vilamoura",
                cat: "experiencias",
                icon: "ğŸš²",
                info: { pt: "Aluguer de bicicletas. 20â‚¬/dia.", en: "Bike rental. â‚¬20/day." },
                tel: "",
                web: "https://bajabikes.eu",
                lat: 37.0775,
                lng: -8.1165,
                img: placeholder("Baja-Bikes")
            },
            {
                nome: "Bike-a-Wish Tours",
                cat: "experiencias",
                icon: "ğŸš´",
                info: { pt: "Tours de bicicleta e aluguer ecolÃ³gico.", en: "Eco-friendly bike tours and rental." },
                tel: "",
                web: "https://bikeawish.com",
                lat: 37.0780,
                lng: -8.1160,
                img: placeholder("Bike-a-Wish")
            },
            {
                nome: "Avalanche Bikes",
                cat: "experiencias",
                icon: "ğŸšµ",
                info: { pt: "Aluguer de mountain bikes. 15â‚¬/dia.", en: "Mountain bike rental. â‚¬15/day." },
                tel: "",
                web: "https://avalanchealgarve.com",
                lat: 37.0785,
                lng: -8.1155,
                img: placeholder("Avalanche-Bikes")
            },
            {
                nome: "Vilamoura Fishing",
                cat: "experiencias",
                icon: "ğŸ£",
                info: { pt: "Pesca desportiva. Reef e big game fishing.", en: "Sport fishing. Reef and big game fishing." },
                tel: "",
                web: "",
                lat: 37.0735,
                lng: -8.1205,
                img: placeholder("Fishing")
            },
            {
                nome: "Centro HÃ­pico Vilamoura",
                cat: "experiencias",
                icon: "ğŸ‡",
                info: { pt: "Atividades equestres. Passeios a cavalo.", en: "Equestrian activities. Horse riding tours." },
                tel: "",
                web: "",
                lat: 37.0790,
                lng: -8.1150,
                img: placeholder("Equestrian")
            }
        ];

        function showMessage(text, isError = false) {
            const div = document.createElement('div');
            div.className = isError ? 'error' : 'success';
            div.textContent = text;
            document.getElementById('messages').appendChild(div);
            setTimeout(() => div.remove(), 6000);
        }

        async function importTransportes() {
            try {
                let count = 0;
                for (const item of transportes) {
                    await db.collection('locais').add(item);
                    count++;
                }
                showMessage(`âœ… ${count} negÃ³cios de Transportes importados!`);
            } catch (error) {
                showMessage(`âŒ Erro: ${error.message}`, true);
            }
        }

        async function importExperiencias() {
            try {
                let count = 0;
                for (const item of experiencias) {
                    await db.collection('locais').add(item);
                    count++;
                }
                showMessage(`âœ… ${count} negÃ³cios de ExperiÃªncias importados!`);
            } catch (error) {
                showMessage(`âŒ Erro: ${error.message}`, true);
            }
        }

        async function checkData() {
            try {
                const snapshot = await db.collection('locais').get();
                const transportes = snapshot.docs.filter(d => d.data().cat === 'transportes').length;
                const experiencias = snapshot.docs.filter(d => d.data().cat === 'experiencias').length;
                const total = snapshot.size;
                showMessage(`ğŸ“Š Total: ${total} | Transportes: ${transportes} | ExperiÃªncias: ${experiencias}`);
            } catch (error) {
                showMessage(`âŒ Erro: ${error.message}`, true);
            }
        }

        async function cleanDuplicates() {
            try {
                const snapshot = await db.collection('locais').get();
                const names = {};
                let deleted = 0;
                
                for (const doc of snapshot.docs) {
                    const data = doc.data();
                    const cat = data.cat;
                    const nome = data.nome;
                    
                    if (cat === 'transportes' || cat === 'experiencias') {
                        const key = `${cat}-${nome}`;
                        if (names[key]) {
                            await doc.ref.delete();
                            deleted++;
                        } else {
                            names[key] = true;
                        }
                    }
                }
                showMessage(deleted > 0 ? `ğŸ—‘ï¸ ${deleted} duplicados removidos!` : 'âœ… Sem duplicados encontrados.');
            } catch (error) {
                showMessage(`âŒ Erro: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>